# Main parameters =========================

# run

SOLVER_NAME = '2D_cylinder'

SOLVER_TYPE = INCOMPRESSIBLE

NDIM = 2

CFL = 0.9

FOURIER = 0.15

DT_MAX = 1.E-2

#DT = 5E-4

#NITER_MAX = 5000 #5000

TIME_MAX = 200.

#DUMP_NITER_PERIOD = 10

DUMP_TIME_PERIOD = 0.5

ITER_INFO_PERIOD = 5

PRINT_FLOW_RATES = TRUE



# schemes

TIME_INT = TFV4A

SPACE_INT = 4TH

IMPLICIT_DIFFUSION = TRUE



# debug

DEBUG_LEVEL_MASTER = 3

DEBUG_LEVEL_SLAVE = 1

DEBUG_WAIT = 0



# Grid partitioning

NELEMENTPERGROUP = 200

MAIN_GRID_REFINEMENT = 0



# parameters

KINEMATIC_VISCOSITY = 0.006666667  # Re=150

POISSON_SOLVER = DPCG

PRESSURE_CONVERGENCE = 1.E-9

Q_CRITERION = 2

VORTICITY = 2



# scalars

SCALAR Z TYPE = PASSIVE

SCALAR Z SC = 1.0

SCALAR Z SC_TURB = 1.0

SCALAR Z SC_ARTIF = 1.0



SCALAR Z_WALL_GRAD TYPE = POSTPROC

SCALAR Z_WALL_GRAD POSTPROC_TYPE = WALL_NORMAL_GRADIENT

SCALAR Z_WALL_GRAD SOURCE = Z



SCALAR U_WALL_GRAD TYPE = POSTPROC

SCALAR U_WALL_GRAD POSTPROC_TYPE = WALL_NORMAL_GRADIENT

SCALAR U_WALL_GRAD SOURCE = U

SCALAR U_WALL_GRAD TANGENTIAL_PART_ONLY = TRUE



SCALAR Y_PLUS TYPE = POSTPROC

SCALAR Y_PLUS POSTPROC_TYPE = Y_PLUS



SCALAR NUSSELT TYPE = POSTPROC

SCALAR NUSSELT POSTPROC_TYPE = NUSSELT

SCALAR NUSSELT SOURCE = Z

SCALAR NUSSELT REFERENCE_VALUE = 1.0

SCALAR NUSSELT REFERENCE_LENGTH = 1.E-2



# stats

STATS U



# sponge layer

SPONGE_LAYER_THICKNESS = 10

SPONGE_LAYER_FACTOR = 30.0



# Restart =================================

#RESTART_TYPE = GAMBIT

#RESTART_GAMBIT_MSH = 'meshes/2D_cyl_26.msh'

#RESTART_GAMBIT_SCALING = 100



RESTART_TYPE = GMSH

RESTART_GMSH_FILE = '2D_cylinder.msh22'

RESTART_GMSH_NODE_SWAPPING = TRUE



#RESTART_TYPE = XMF

#RESTART_XMF_SOLUTION = 'restart/2D_cyl.sol000001.xmf'



# boundaries ==============================

#BOUNDARY x0 DESCRIPTION = 'Channel inlet'

BOUNDARY x0 TYPE = INLET

BOUNDARY x0 U = 1.0 0.0 0.0

BOUNDARY x0 Z = 1.0

#BOUNDARY x0 LABEL = 'X'



#BOUNDARY x1 DESCRIPTION = 'Channel outlet'

BOUNDARY x1 TYPE = OUTLET

#BOUNDARY x1 LABEL = 'X'



#BOUNDARY y0 DESCRIPTION = 'Lower wall'

BOUNDARY y0 TYPE = SLIP_WALL

#BOUNDARY y0 WALL_TYPE = TRANSLATING

#BOUNDARY y0 U = 0.30 0.0

#BOUNDARY y0 LABEL = 'Y'



#BOUNDARY y1 DESCRIPTION = 'Upper wall'

BOUNDARY y1 TYPE = SLIP_WALL

#BOUNDARY y1 WALL_TYPE = TRANSLATING

#BOUNDARY y1 U = 0.30 0.0

#BOUNDARY y1 LABEL = 'Y'



#BOUNDARY cyl DESCRIPTION = 'Cylinder wall'

BOUNDARY cyl TYPE = WALL

BOUNDARY cyl Z = 0.0

# Angular velocity and frequency

CYL_ROTATION_PROP = 3.0 0.1 

BOUNDARY cyl WALL_TYPE = ROTATING

BOUNDARY cyl CENTER = 0.0 0.0

BOUNDARY cyl ROTATION_SPEED = 0.0

#BOUNDARY cyl LABEL = 'CYL'



# Dump ====================================

DUMP_TYPE = XMF

DUMP_NPART = 1

DUMP_MAX_IO_ACCESSES = 2

DUMP_PREFIX = 'dump/2D_cyl.sol'

#DUMP_GEOMETRY = ALWAYS

#DUMP_ELEMENT_FLAGGING = SCALAR_RANGE

#DUMP_ELEMENT_FLAGGING_SCALAR = U

#DUMP_ELEMENT_FLAGGING_SCALAR_MIN = 0.16

#DUMP_ELEMENT_FLAGGING_SCALAR_MAX = 0.2



###########################

SCALAR TAU TYPE = POSTPROC

SCALAR TAU POSTPROC_TYPE = TAU_WALL_VECTOR



# temporals

TEMPORAL temporal0 TYPE = ASCII

TEMPORAL temporal0 FILE = "ics_temporals.txt"

TEMPORAL temporal0 APPEND = FALSE

TEMPORAL temporal0 NITER_PERIOD = 1

TEMPORAL temporal0 DUMP_NBUFFER = 10



TEMPORAL_DATA Cp TYPE = SURFACE_NORMAL_INTEGRAL

TEMPORAL_DATA Cp DESTINATION = temporal0

TEMPORAL_DATA Cp SOURCE = P_OVER_RHO

TEMPORAL_DATA Cp BOUNDARY = cyl

TEMPORAL_DATA Cp LABEL = "P_OVER_RHO_INTGRL"



TEMPORAL_DATA Cf TYPE = SURFACE_INTEGRAL

TEMPORAL_DATA Cf DESTINATION = temporal0

TEMPORAL_DATA Cf SOURCE = TAU

TEMPORAL_DATA Cf BOUNDARY = cyl

TEMPORAL_DATA Cf LABEL = "TAU_INTGRL"

###########################
